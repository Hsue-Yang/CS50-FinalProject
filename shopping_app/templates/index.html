{% extends 'base.html' %}
{% load static %}
{% block title %}Price Compare - Find the Best Deals{% endblock %}
{% block content %}
  <div class="container">
    <!-- Hero Section -->
    <div class="hero-section">
      <h1 class="display-4 fw-bold mb-3">
        <i class="fas fa-chart-line me-3"></i>Price Compare
      </h1>
      <p class="lead mb-4">Easily compare prices across multiple shopping sites and find the best deals</p>
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="input-group input-group-lg">
            <input type="text"
                   class="form-control search-input"
                   id="searchInput"
                   placeholder="Enter product name, e.g., iPhone 15, Nike sneakers, MacBook...">
            <button class="btn btn-primary search-btn"
                    type="button"
                    onclick="searchProducts()">
              <i class="fas fa-search me-2"></i>Search
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Supported Sites -->
    <div class="supported-sites">
      <h4 class="text-center mb-4">
        <i class="fas fa-store me-2"></i>Supported Shopping Sites
      </h4>
      <div class="row text-center">
        <div class="col-6 col-md-6 mb-3">
          <div class="site-logo">
            <i class="fas fa-shopping-cart"></i>
          </div>
          <small>PChome</small>
        </div>
        <div class="col-6 col-md-6 mb-3">
          <div class="site-logo">
            <i class="fas fa-shopping-bag"></i>
          </div>
          <small>momo</small>
        </div>
      </div>
    </div>
    <!-- Site Selector -->
    <div class="website-selector">
      <h5 class="mb-3">
        <i class="fas fa-filter me-2"></i>Select Sites to Compare
      </h5>
      <div id="websiteChips">
        <span class="website-chip" data-site="pchome">
          <i class="fas fa-shopping-cart me-1"></i>PChome
        </span>
        <span class="website-chip" data-site="momo">
          <i class="fas fa-shopping-bag me-1"></i>momo
        </span>
      </div>
      <small class="text-muted">Click to select sites to compare (All selected by default)</small>
    </div>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
      <div class="spinner-border text-primary"
           style="width: 3rem;
                  height: 3rem"
           role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <h5 class="mt-3">Searching for products...</h5>
      <p class="text-muted">Please wait while we search the best prices across shopping websites</p>
    </div>
    <!-- Search Results -->
    <div id="searchResults" class="row g-4 mt-3"></div>
    <!-- Infinite Scroll Sentinel -->
    <div id="sentinel" class="loading-ui py-3 text-center text-muted">
      <div class="spinner-border text-secondary"
           style="width: 2rem;
                  height: 2rem"
           role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <div id="sentinelText" class="mt-2">Loading...</div>
    </div>
    <!-- No Results Message -->
    <div class="no-results" id="noResults" style="display: none;">
      <i class="fas fa-search fa-3x mb-3"></i>
      <h4>No matching products found</h4>
      <p>Try the following:</p>
      <ul class="list-unstyled">
        <li>• Check for typos in the keyword</li>
        <li>• Use simpler keywords</li>
        <li>• Select more shopping sites</li>
      </ul>
    </div>
  </div>
{% endblock %}
{% block extra_js %}
  <script src="{% static 'js/index.js' %}?v={{timestamp}}"></script>
{% endblock %}
